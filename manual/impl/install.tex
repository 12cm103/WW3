\vssub
\subsection{~Installing files}\label{sec:install}
\vssub

\noindent
In its packaged version, \ws\ is contained in several files:

\begin{list}{???}{\parsep 0mm \itemsep 0mm 
                  \leftmargin 40mm \rightmargin 5mm
                  \labelwidth 30mm \labelsep 5mm}
\item[{\file install\_wwatch3} \hfill]
The \ws\ install program. 
\item[{\file wwatch3.aux.tar} \hfill] Archive file containing programs and
scripts controlling the compiling and linking of and code management of \ws.
\item[{\file wwatch3.ftn.tar} \hfill]
Archive file containing source code.
\item[{\file wwatch3.inp.tar} \hfill]
Archive file containing example input files. 
\item[{\file wwatch3.tst.tar} \hfill]
Archive file containing test cases with results. 
\end{list}

\noindent
As the first step of installing \ws, these files have to be copied to a work
directory on the machine on which \ws\ will be installed. Because this
directory will be the `home' directory of \ws, it is suggested that a new
directory is created (see also warning in previous section). Furthermore
{\file install\_wwatch3} has to be made executable by typing \command{chmod
700 install\_wwatch3} after which the installation of the files is started by
typing \command{install\_wwatch3}


\begin{center}
\rule[1mm]{55mm}{1.0mm} WARNING \rule[1mm]{55mm}{1.0mm} \\ 
\vspace{\baselineskip}
\parbox{120mm}{The install program will ask for a compiler to compile some
auxiliary \fortran\ codes used in putting \ws\ together. Unlike the actual
\ws\ source code, these programs are still written in \fortran-77. It is
therefore sufficient to point toward the generic \fortran-77 compiler on the
system. This choice of mixed codes was made to assure that if \ws\ is put on a
\unix/Linux box only to put the code together, it will not be necessary to buy
a \fortran-90 compiler.} \\ \vspace{\baselineskip} \rule[1mm]{55mm}{1.0mm}
WARNING \rule[1mm]{55mm}{1.0mm}
\end{center}

When {\file install\_wwatch3} is executed for the first time, it will ask the
user to identify the directory in which \ws\ will be installed. This has to be
the directory in which the above five files reside. The program will then
print a message that it cannot find the setup file, and ask some
questions. The default answer or options are shown in square brackets. After
the user has verified that the setup parameters are satisfactorily, the
install program will, by default, create the (hidden) setup file {\file
  .wwatch3.env} in the user's home directory.  An alternate setup file may be
specified prior to running {\file install\_wwatch3} by setting {\code
  WWATCH3\_ENV} in the user environment.  The setup can be modified by
rerunning the install program, or by manually editing the setup file. The
`home' directory of \ws\ can only be changed by editing or removing {\file
  .wwatch3.env} or by changing {\code WWATCH3\_ENV} in the user environment.

After the setup file is processed, the install program asks if the user wants
to continue with the installation. If the user chooses to continue, the
program will look for the archive files. If a file is found, the program asks
if the contents of the file should be installed. If no files are found, the
archive files do not reside in the home directory, or the home directory is
erroneously defined. To avoid that the install program generates unwanted
files and directories in such a case, abort the install program (type Ctrl C),
and check the location of the archive files, and the `home' directory of \ws\
(see previous paragraph).

After files to be unpacked have been identified, the program will ask if old
files should be overwritten automatically. If the user chooses `n', the
program will ask permission to overwrite each file that already exists. Files
that contain user specific information, such as compile and link options, will
never be replaced by the install program.

As the first step of the actual installation, the install program checks if
the following directories exist in the `home' directory of \ws.
 
\begin{dlist}
\dit{arc }{Archive directory.}
\dit{aux }{Raw auxiliary programs (source codes etc.).}
\dit{bin }{Executables and shell scripts for compiling and linking.}
\dit{exe }{\ws\ executables.}
\dit{ftn }{Source code and makefile.}
\dit{inp }{Input files.}
\dit{mod }{Module files.}
\dit{obj }{Object files.}
\dit{test}{Scripts with test cases.}
\dit{work}{Auxiliary work directory.}
\end{dlist}

\noindent
All these directories are generated by the install program {\file
install\_wwatch3}, except for the archive directory, which is generated by
{\file arc\_wwatch3} (see below).

If installation of the auxiliary programs is requested (file {\file
wwatch3.aux.tar}), the install program will first process source codes of
auxiliary programs, using the compiler as defined by the user in the setup
file. Note that these codes are still in fixed format \fortran-77.

\begin{flist}
\fit{w3adc.f }{\ws\ {\fortran} preprocessor.}
\fit{w3prnt.f}{Print files (source codes) including page and line numbers.}
\fit{w3list.f}{Generate a generic source code listing.}

\fit{w3split.f}{Generate spectral bulletin identifying individual wave fields
  within a spectrum from the spectral output of the point output
  post-processor (see \para\ref{sec:ww3outp}). This is a legacy code
  superseded by generating bulletins directly from {\file ww3\_outp}. It is
  retained here for historical reasons only.}

\end{flist}

\noindent
The above source codes are stored in the directory {\dir aux} and the
executables are stored in the directory {\dir bin}. A more detailed
description of these programs (including instructions on running the
executables) can be found in the documentation included in the above source
code files. After the compilation of these programs, several \unix\ shell
scripts and auxiliary files are installed in the {\dir bin} directory.

\begin{flist}
\fit{ad3              }{Script to run the preprocessor {\file w3adc}
                        and the compile script {\file comp} for a given
                        source code file.}
\fit{ad3\_test        }{Test version of {\file ad3}, showing modifications
                        to original source file. This script does not
                        compile code.}
\fit{all\_switches    }{Generates a list of all {\code w3adc} switches 
                        present in the source code files.}
\fit{arc\_wwatch3     }{Program to archive versions of \ws\ in the 
                        directory {\dir arc}.}
\fit{comp.gen         }{Generic compiler script. The actual compiler
                        script {\file comp} will be copied from this
                        script if it does not exists.}
\fit{comp.{\it xxx}   }{The compiler script {\file comp} for a specific
                        hardware-compiler combination.}
\fit{find\_switch     }{Script to find \ws\ source code files containing 
                       compiler switches (or arbitrary strings).}
\fit{install\_ww3\_svn }{\ldots}
\fit{install\_ww3\_svn\_full }{\ldots}
\fit{install\_ww3\_svn\_model }{\ldots}
\fit{install\_ww3\_tar }{\ldots}
\fit{link.gen         }{Generic linker script. Actual script is {\file
                        link}.}
\fit{link.{\it xxx}   }{The link script {\file comp} for a specific
                        hardware-compiler combination.}
\fit{list             }{Script to print source code listing using 
                        {\file w3prnt}.}
\fit{ln3              }{Script to make symbolic link of source code file
                        to work directory.}
\fit{make\_MPI        }{Script to separately compile MPI and non-MPI programs.}
\fit{make\_makefile.sh}{Script to generate the of the makefile based
                        on selections in the file {\file switch})}. 
\fit{switch.gen       }{Generic file with preprocessor switches
                        (\para\ref{sec:switches}).}
\fit{w3\_clean        }{Script to clean up work and scratch directories
                        by removing files generated during compilation or
                        test runs.}
\fit{w3\_make         }{Script to compile and link components of \ws\
                        using a makefile.}
\fit{w3\_new          }{Script to touch correct source code files
                        to account for changes in compiler switches in
                        combination with the makefile.} 
\fit{w3\_setup        }{Script for creating/editing the \ws\ environment setup
                        file. The default setup file is
                        {\file \$\{HOME\}/.wwatch3.env}.  An alternate setup
                        file can be specified with the {\code WWATCH3\_ENV}
                        environment variable.}
\fit{w3\_source       }{Script to generate a true \fortran\ source
                        code for any of he \ws\ program elements.}
\fit{ww3\_gspl.sh     }{Script to automate use of {\file ww3\_gspl} program 
                        (see \para\ref{sub:ww3gspl}).}
\end{flist}

\noindent
The use of these scripts is explained in \para\ref{sec:comp}.  Note that the
above scripts acquire setup information from the \ws\ environment setup file
defined by {\code WWATCH3\_ENV}, or, if that is not defined, from the default
setup file {\file .wwatch3.env} in the home directory of the user.

\noindent
After installation in the {\dir bin} directory, several GrADS scripts are
installed in the {\dir aux} directory.

\begin{flist}
\fit{cbarn.gs         }{Semi-standard GrADS script for displaying
                        color bars.}
\fit{colorset.gs      }{Script to define colors used in shading.}
\fit{profile.gs}      {Script to display profiling data generated by {\file
                       ww3\_multi}.} 
\fit{source.gs}       {Script for composite plot of spectra and source
                       terms (2-D polar or Cartesian plots in color or in
                       black and white).}
\fit{1source.gs}      {Script to plot single source term.}
\fit{spec.gs}         {Script to plot spectra.}
\fit{spec\_ids.gen}   {DAta file used by spectral / source scripts.}
\end{flist}

\noindent
As the final step of processing {\file wwatch3.aux.tar}, some links between
directories are established.

If the installation of the source code is requested (file {\file
wwatch3.ftn.tar}), the install program will copy source code and include files
to the directory {\dir ftn}. All the files considered are discussed in detail
in chapter~\ref{chapt:sys}.

If the installation of the input files is requested (file {\file
wwatch3.inp.tar}), the install program will copy the example input files as
presented in the previous chapter to the directory {\dir inp}. Links are make
to the work directory {\dir work}. No other action is taken.

If the installation of the test cases is requested (file {\file
wwatch3.tst.tar}), the install program will copy the test cases to the
directory {\dir test} (see~\para\ref{sec:tests}). No other action is taken.

Finally, the install program lists manual modifications required by or
suggested to the user. These messages are printed only if the compile and link
system are installed (file {\file wwatch3.aux.tar}).